<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<script src="https://code.jquery.com/jquery-3.7.1.min.js"
	integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
	crossorigin="anonymous"></script>
<script>
	$(function() {
		let msg = "${msg}";
		if(msg != ""){
			alert(msg);
		}
	});

</script>
</head>


<body>
	<h1>Sign Up</h1>
	<form action="signUpProc" method="post" enctype="multipart/form-data" onsubmit="return validateForm()">  
        <input type="email" placeholder="이메일" name="m_email" id="signUpEamil" required>
        <span id="emailCheckResult"></span><br>
		<input type="password" placeholder="비밀번호" name="m_password" required><br>
		<input type="text" placeholder="이름" name="m_name" required> 
		<input type="text" placeholder="전화번호" name="m_phoneNumber" required>
		<input type="text" placeholder="주소" name="m_address" required>
		<input type="text" placeholder="나이" name="m_age" required>
		<input type="text" placeholder="프로필사진">
		
        
		<input type="submit" value="회원가입" >
		<br>
	</form>
		
		 
		
		<button onclick="location.href='./'">홈페이지 돌아가기</button>
		
		
</body>
<script>
function validateForm() {
    // 이메일 중복 체크 결과를 가져옴
    let result = $("#emailCheckResult").text();
    
    // 중복된 경우
    if (result === "중복된 이메일입니다.") {
        alert("중복된 이메일입니다. 다른 이메일을 입력해주세요.");
        return false; // 회원가입 막기
    }
    
    // 사용 가능한 경우
    return true; // 회원가입 허용
}


$(document).ready(function() {
    // 문서가 준비되면 실행되는 함수
    $("#signUpEamil").blur(function() {
        // 'signUpEamil'이라는 ID를 가진 입력 필드에서 blur 이벤트가 발생했을 때 실행되는 함수
        let email = $(this).val();
        // 'signUpEamil' 필드의 값(value)을 가져와서 'email' 변수에 저장
        if (email.trim() === "") {
            $("#emailCheckResult").text("이메일을 입력해주세요.");
            return;
        }else if (email.indexOf('@') === -1) {
        	//indexOf("")는 문자열이 포함되지 안흥면 무조건 -1값이 반환됨.
            $("#emailCheckResult").text("올바르지 않은 이메일입니다.")
        } 
        $.post("emailCheckResult", { m_email: email }, function(result) {
            // 서버로 POST 요청을 보내는데, 요청 경로는 "emailCheckResult"이고, 데이터로 'm_email'을 키로 하는 'email' 값을 전송
            // 성공적으로 요청이 완료되면 실행되는 함수, 서버에서 반환한 결과가 'result' 매개변수로 전달됨
            $("#emailCheckResult").text(result);
            // 'emailCheckResult'라는 ID를 가진 요소에 서버에서 받은 결과를 텍스트로 설정하여 표시	  
      		  	});
        	
        });
    });
</script>
</html>